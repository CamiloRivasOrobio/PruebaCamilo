@using sistema.Models
@model ProductoInsumoMedicoViewModel
@Html.HiddenFor(p=>p.Id)

<div class="main-card mb-3 card">
    <div class="card-body">
        <div class="main-card mb-3 card">
            <div class="card-body">
                <div class="form-row">
                    <div class="col-md-12">
                        <h5><b>Datos del producto</b></h5>
                        <hr />
                    </div>
                    <div class="col-md-6">
                        <div class="position-relative form-group">
                            <label>Código de referencia</label>
                            @Html.TextBoxFor(a => a.CodigoReferencia, new {@class="form-control",
                            @placeholder="Código de referencia"})
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label>Nombre comercial</label>
                        @Html.TextBoxFor(a => a.Nombre, new {@class="form-control", @placeholder="Nombre comercial"})
                    </div>
                    <div class="col-md-6 form-row">
                        <div class="col-md-12">
                            <label>Categoría</label>
                        </div>
                        <div class="col-md-12">
                            <select class="form-control" data-bind="options: categorias,
                                                                        optionsText: 'NombreCategoria',
                                                                        value: categoriaSeleccionada">
                            </select>
                        </div>
                        <div class="col-md-12">
                            <div class="main-card mb-3 card">
                                <div class="card-body form-row">
                                    <div class="col-md-12">
                                        <b>Agregar categoría</b>
                                    </div>
                                    <div class="col-md-8">
                                        <input class="form-control" placeholder="Nueva categoría" data-bind="value:nombreNuevaCategoria" />
                                    </div>
                                    <div class="col-md-4">
                                        <button class="btn btn-success" data-bind="click:registrarNuevaCategoria">Agregar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 form-row">
                        <div class="col-md-12">
                            <label>Marca</label>
                        </div>
                        <div class="col-md-12">
                            <select class="form-control" data-bind="options: marcas,
                                                                        optionsText: 'NombreMarca',
                                                                        value: marcaSeleccionada">
                            </select>
                        </div>
                        <div class="col-md-12">
                            <div class="main-card mb-3 card">
                                <div class="card-body form-row">
                                    <div class="col-md-12">
                                        <b>Agregar marca</b>
                                    </div>
                                    <div class="col-md-8">
                                        <input class="form-control" placeholder="Nueva marca" />
                                    </div>
                                    <div class="col-md-4">
                                        <button class="btn btn-success" data-bind="click:registrarNuevaMarca">Agregar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 form-row">
                        <div class="col-md-12">
                            <label>Grupo</label>
                        </div>
                        <div class="col-md-12">
                            <select class="form-control" data-bind="options: gruposT,
                                                                        optionsText: 'NombreGrupoT',
                                                                        value: grupoTSeleccionado">
                            </select>
                        </div>
                        <div class="col-md-12">
                            <div class="main-card mb-3 card">
                                <div class="card-body form-row">
                                    <div class="col-md-12">
                                        <b>Agregar grupo</b>
                                    </div>
                                    <div class="col-md-8">
                                        <input class="form-control" placeholder="Nuevo grupo" data-bind="value:nombreNuevoGrupoT" />
                                    </div>
                                    <div class="col-md-4">
                                        <button class="btn btn-success" data-bind="click:registrarNuevoGrupoT">Agregar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6 form-row">
                        <div class="col-md-12">
                            <label>Presentación</label>
                        </div>
                        <div class="col-md-12">
                            <select class="form-control" data-bind="options: presentaciones,
                                                                        optionsText: 'PresentProducto',
                                                                        value: presentacionSeleccionada">
                            </select>
                        </div>
                        <div class="col-md-12">
                            <div class="main-card mb-3 card">
                                <div class="card-body form-row">
                                    <div class="col-md-12">
                                        <b>Agregar presentación</b>
                                    </div>
                                    <div class="col-md-8">
                                        <input class="form-control" placeholder="Nueva presentación" data-bind="value:nombreNuevaPresentacion" />
                                    </div>
                                    <div class="col-md-4">
                                        <button class="btn btn-success" data-bind="click:registrarNuevaPresentacion">Agregar</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <label class="">Imagen de referencia</label>
                        @Html.TextBoxFor(a => a.UrlImagen, new {@class="form-control",
                        @placeholder="Pegar link imagen..."})
                    </div>
                    <div class="col-md-12">
                        <label>Descripción</label>
                        @Html.TextAreaFor(a => a.Descripcion,new {
                        @class="form-control ", @placeholder="Descripción"})
                    </div>
                </div>
            </div>
        </div>

        <div class="main-card mb-3 card">
            <div class="card-body">
                <div class="form-row">
                    <div class="col-md-12">
                        <h5><b>Tabla de equivalencias</b></h5>
                        <hr />
                    </div>
                    <div class="col-md-12">
                        <h6><b>Seleccione la unidad de compra:</b></h6>
                    </div>
                    <div class="col-md-12">
                        <div class="form-row">
                            <!--ko foreach: unidadesCompra-->
                            <div class="unidad-compra" data-bind="attr: {id:'unidad-compra-'+Id}, click: $root.seleccionarUnidadCompra">
                                <center>
                                    <span data-bind="text: Nombre"></span> (<span data-bind="text: Abreviatura"></span>)
                                </center>
                            </div>
                            <!--/ko-->
                        </div>
                        <hr />
                    </div>
                    <div class="col-md-12">
                        <div class="main-card mb-3 card">
                            <div class="card-body form-row">
                                <div class="col-md-12">
                                    <b>Agregar unidad de compra</b>
                                </div>
                                <div class="col-md-4">
                                    <label>Nombre</label>
                                    <input class="form-control" placeholder="Nombre" data-bind="value:nombreNuevoGrupoT" />
                                </div>
                                <div class="col-md-4">
                                    <label>Abreviatura</label>
                                    <input class="form-control" placeholder="Abreviatura" data-bind="value:nombreNuevoGrupoT" />
                                </div>
                                <div class="col-md-4">
                                    <button class="btn btn-success" data-bind="click:registrarNuevoGrupoT">Agregar</button>
                                </div>
                            </div>
                        </div>
                        <hr />
                    </div>
                    <div class="col-md-12">
                        <h6><b>Seleccione la unidad de venta:</b></h6>
                    </div>
                    <div class="col-md-10">
                        <div class="form-row">
                            <!--ko foreach: unidadesVenta-->
                            <div class="unidad-venta" data-bind="attr: {id:'unidad-venta-'+Id}, click: $root.seleccionarUnidadVenta">
                                <center>
                                    <span data-bind="text: Nombre"></span> (<span data-bind="text: Abreviatura"></span>)
                                </center>
                            </div>
                            <!--/ko-->
                        </div>
                        <hr />
                    </div>
                    <div class="col-md-12">
                        <div class="main-card mb-3 card">
                            <div class="card-body form-row">
                                <div class="col-md-12">
                                    <b>Agregar unidad de venta</b>
                                </div>
                                <div class="col-md-4">
                                    <label>Nombre</label>
                                    <input class="form-control" placeholder="Nombre" data-bind="value:nombreNuevoGrupoT" />
                                </div>
                                <div class="col-md-4">
                                    <label>Abreviatura</label>
                                    <input class="form-control" placeholder="Abreviatura" data-bind="value:nombreNuevoGrupoT" />
                                </div>
                                <div class="col-md-4">
                                    <button class="btn btn-success" data-bind="click:registrarNuevoGrupoT">Agregar</button>
                                </div>
                            </div>
                        </div>
                        <hr />
                    </div>
                    <div class="col-md-12">
                        <br />
                        <button class="btn btn-primary" data-bind="click: agregarEquivalencia">Agregar equivalencia</button>
                    </div>
                    <div class="col-md-12">
                        <br />
                        <table class="table-hover mb-0 table">
                            <thead>
                                <tr>
                                    <th><b>Unidad de compra</b></th>
                                    <th><b>Unidad de venta</b></th>
                                    <th><b>Cantidad equivalente</b></th>
                                    <th></th>
                                </tr>
                            </thead>
                            <tbody>
                                <!--ko foreach: equivalenciasProducto-->
                                <tr>
                                    <td data-bind="text: UnidadMedidaCompraNombre"></td>
                                    <td data-bind="text: UnidadMedidaVentaNombre"></td>
                                    <td><input type="number" step=".01" class="form-control" data-bind="value: CantidadEquivalente" /></td>
                                    <td><button class="btn btn-danger" data-bind="click: $root.quitarEquivalencia">Quitar</button></td>
                                </tr>
                                <!--/ko-->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .unidad-compra.unidad-seleccionada,
    .unidad-venta.unidad-seleccionada {
        background-color: lightgray;
    }

    .unidad-compra,
    .unidad-venta {
        background-color: white;
        border: 1px solid gray;
        padding: 5px;
        border-radius: 5px;
        cursor: pointer;
    }
</style>